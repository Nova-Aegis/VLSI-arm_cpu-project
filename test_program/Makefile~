CC = /usr/bin/arm-linux-gnu-gcc
AS_ARM = /usr/bin/arm-linux-gnu-as
LD_ARM = /usr/bin/arm-linux-gnu-ld
CFLAGS = -march=armv2a -mno-thumb-interwork -Wall -O1
LD_FLAGS = -Bstatic -fix-v4bx

PROG1 = small_program_sum

all : $(PROG1)

%.o : %.c
	$(CC) $(CFLAGS) -g -o $@ -c $^

$(PROG1) : $(PROG1).o
	$(LD_ARM) $(LD_FLAGS) -g -o $@ $^

OBJDUMP = /usr/bin/arm-linux-gnu-readelf

objdump :
	echo "OBJDUMP" > $(PROG1).dump
	$(OBJDUMP) -A $(PROG1) >> $(PROG1).dump
	$(OBJDUMP) -x .text $(PROG1) >> $(PROG1).dump
	$(OBJDUMP) -x .data $(PROG1) >> $(PROG1).dump

.PHONY : all objdump
